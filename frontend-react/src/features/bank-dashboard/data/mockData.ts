import { Customer, Document, Message } from './types';

// =============================================================================
// Mock Customer Data
// =============================================================================

export const mockCustomers: Customer[] = [
  {
    customer_id: 'C0001',
    business_name: 'Green Solutions',
    segment: 'microbusiness',
    industry: 'Retail',
    annual_revenue: 167026,
    number_of_employees: 3,
    loan_amount: 73736,
    loan_product: 'Government-Backed Loan',
    credit_score_bucket: 'low',
    risk_rating: 7,
    relationship_length_years: 2.8,
    region: 'British Columbia',
    is_collateralized: true,
    interest_rate: 4.25,
    delinquency_count_12m: 0,
    loan_outcome: 'renewed',
    churn_label: 0,
    customer_persona: 'thoughtful_manager',
  },
  {
    customer_id: 'C0002',
    business_name: 'Summit Enterprises',
    segment: 'SME',
    industry: 'Retail',
    annual_revenue: 7590293,
    number_of_employees: 97,
    loan_amount: 165684,
    loan_product: 'Line of Credit',
    credit_score_bucket: 'medium',
    risk_rating: 6,
    relationship_length_years: 8.1,
    region: 'Territories',
    is_collateralized: true,
    interest_rate: 6.54,
    delinquency_count_12m: 0,
    loan_outcome: 'approved',
    churn_label: 0,
    customer_persona: 'thoughtful_manager',
  },
  {
    customer_id: 'C0003',
    business_name: 'North Retail',
    segment: 'SME',
    industry: 'Manufacturing',
    annual_revenue: 6567228,
    number_of_employees: 157,
    loan_amount: 120814,
    loan_product: 'Term Loan',
    credit_score_bucket: 'low',
    risk_rating: 4,
    relationship_length_years: 3.0,
    region: 'Alberta',
    is_collateralized: false,
    interest_rate: 11.38,
    delinquency_count_12m: 2,
    loan_outcome: 'closed_paid_off',
    churn_label: 1,
    customer_persona: 'busy_founder',
  },
  {
    customer_id: 'C0004',
    business_name: 'Green Consulting',
    segment: 'SME',
    industry: 'Hospitality',
    annual_revenue: 1697935,
    number_of_employees: 165,
    loan_amount: 352911,
    loan_product: 'Line of Credit',
    credit_score_bucket: 'medium',
    risk_rating: 4,
    relationship_length_years: 2.7,
    region: 'British Columbia',
    is_collateralized: true,
    interest_rate: 6.54,
    delinquency_count_12m: 5,
    loan_outcome: 'renewed',
    churn_label: 0,
    customer_persona: 'impatient_owner',
  },
  {
    customer_id: 'C0005',
    business_name: 'Pacific Logistics',
    segment: 'SME',
    industry: 'Transportation',
    annual_revenue: 4250000,
    number_of_employees: 45,
    loan_amount: 500000,
    loan_product: 'Term Loan',
    credit_score_bucket: 'high',
    risk_rating: 2,
    relationship_length_years: 5.5,
    region: 'Ontario',
    is_collateralized: true,
    interest_rate: 5.25,
    delinquency_count_12m: 0,
    loan_outcome: 'approved',
    churn_label: 0,
    customer_persona: 'strategic_planner',
  },
  {
    customer_id: 'C0006',
    business_name: 'Tech Innovators Inc',
    segment: 'SME',
    industry: 'Technology',
    annual_revenue: 12500000,
    number_of_employees: 85,
    loan_amount: 750000,
    loan_product: 'Line of Credit',
    credit_score_bucket: 'high',
    risk_rating: 3,
    relationship_length_years: 4.2,
    region: 'Quebec',
    is_collateralized: false,
    interest_rate: 7.25,
    delinquency_count_12m: 0,
    loan_outcome: 'renewed',
    churn_label: 0,
    customer_persona: 'growth_focused',
  },
  {
    customer_id: 'C0007',
    business_name: 'Maritime Foods Ltd',
    segment: 'microbusiness',
    industry: 'Food & Beverage',
    annual_revenue: 320000,
    number_of_employees: 8,
    loan_amount: 45000,
    loan_product: 'Government-Backed Loan',
    credit_score_bucket: 'medium',
    risk_rating: 5,
    relationship_length_years: 1.5,
    region: 'Nova Scotia',
    is_collateralized: false,
    interest_rate: 4.75,
    delinquency_count_12m: 1,
    loan_outcome: 'approved',
    churn_label: 0,
    customer_persona: 'cautious_owner',
  },
  {
    customer_id: 'C0008',
    business_name: 'Prairie Construction Co',
    segment: 'SME',
    industry: 'Construction',
    annual_revenue: 8900000,
    number_of_employees: 120,
    loan_amount: 1200000,
    loan_product: 'Term Loan',
    credit_score_bucket: 'medium',
    risk_rating: 6,
    relationship_length_years: 6.8,
    region: 'Saskatchewan',
    is_collateralized: true,
    interest_rate: 8.5,
    delinquency_count_12m: 0,
    loan_outcome: 'renewed',
    churn_label: 0,
    customer_persona: 'relationship_builder',
  },
];

// =============================================================================
// Mock Document Data
// =============================================================================

export const mockDocuments: Document[] = [
  {
    document_id: 'D000001',
    customer_id: 'C0001',
    doc_type: 'tax_return',
    created_at: '2024-04-27T15:42:52',
    title: 'Business Tax Return – Extract',
    language: 'en',
    format: 'markdown',
    content: '# Business Tax Return – Extract\n\nBusiness: Green Solutions\nRegion: British Columbia\nFiscal Year: 2023\n\n## Revenue Summary\n- Gross Revenue: $167,026\n- Net Income: $42,500\n- Tax Liability: $8,925',
  },
  {
    document_id: 'D000002',
    customer_id: 'C0001',
    doc_type: 'financial_statement',
    created_at: '2024-03-15T10:30:00',
    title: 'Q4 2023 Financial Statement',
    language: 'en',
    format: 'markdown',
    content: '# Financial Statement Q4 2023\n\n## Balance Sheet Summary\n- Total Assets: $185,000\n- Total Liabilities: $92,000\n- Equity: $93,000',
  },
  {
    document_id: 'D000003',
    customer_id: 'C0001',
    doc_type: 'loan_agreement',
    created_at: '2022-01-10T09:00:00',
    title: 'Original Loan Agreement',
    language: 'en',
    format: 'pdf',
    content: 'Loan agreement for Government-Backed Loan of $73,736 at 4.25% interest rate.',
  },
  {
    document_id: 'D000004',
    customer_id: 'C0002',
    doc_type: 'tax_return',
    created_at: '2024-04-20T14:22:00',
    title: 'Corporate Tax Return 2023',
    language: 'en',
    format: 'markdown',
    content: '# Corporate Tax Return 2023\n\nBusiness: Summit Enterprises\n\n## Revenue\n- Gross Revenue: $7,590,293\n- Operating Expenses: $6,200,000\n- Net Income: $1,390,293',
  },
  {
    document_id: 'D000005',
    customer_id: 'C0002',
    doc_type: 'business_plan',
    created_at: '2024-02-01T11:00:00',
    title: 'Expansion Business Plan',
    language: 'en',
    format: 'markdown',
    content: '# Business Expansion Plan\n\nSummit Enterprises plans to expand into two new territories in 2024.',
  },
  {
    document_id: 'D000006',
    customer_id: 'C0003',
    doc_type: 'financial_statement',
    created_at: '2024-01-15T09:30:00',
    title: 'Annual Financial Report 2023',
    language: 'en',
    format: 'markdown',
    content: '# Annual Financial Report\n\nNorth Retail - Manufacturing Division\n\n## Summary\n- Revenue: $6,567,228\n- EBITDA: $890,000',
  },
  {
    document_id: 'D000007',
    customer_id: 'C0004',
    doc_type: 'tax_return',
    created_at: '2024-04-18T16:00:00',
    title: 'Tax Return 2023',
    language: 'en',
    format: 'markdown',
    content: '# Tax Return Extract\n\nGreen Consulting\nIndustry: Hospitality',
  },
];

// =============================================================================
// Mock Message Data
// =============================================================================

export const mockMessages: Message[] = [
  {
    message_id: 'M000001',
    customer_id: 'C0001',
    message_time: '2023-09-12T17:42:52',
    channel: 'document_request',
    message_role: 'agent',
    phase_label: 'onboarding',
    agent_id: 'A019',
    agent_persona: 'compliance_analyst',
    agent_role: 'compliance',
    agent_tone: 'formal',
    sentiment: 'positive',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'thoughtful_manager',
    text: 'To continue processing your loan renewal, we kindly ask you to provide us with a copy of your most recent business tax return and up-to-date financial statements. This documentation is essential for completing the initial application phase.',
    referenced_document_ids: 'D000001',
    thread_id: 'TC0001-001',
  },
  {
    message_id: 'M000002',
    customer_id: 'C0001',
    message_time: '2023-09-14T22:42:52',
    channel: 'email',
    message_role: 'agent',
    phase_label: 'onboarding',
    agent_id: 'A012',
    agent_persona: 'compliance_analyst',
    agent_role: 'compliance',
    agent_tone: 'formal',
    sentiment: 'neutral',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'thoughtful_manager',
    text: 'Thank you for inquiring about your loan details. Below, you will find an overview of your current loan conditions, repayment plan, and the primary options should you choose to expand your credit limit.',
    referenced_document_ids: null,
    thread_id: 'TC0001-001',
  },
  {
    message_id: 'M000003',
    customer_id: 'C0001',
    message_time: '2023-09-15T22:42:52',
    channel: 'status_update',
    message_role: 'agent',
    phase_label: 'onboarding',
    agent_id: 'A005',
    agent_persona: 'risk_officer',
    agent_role: 'risk_officer',
    agent_tone: 'formal',
    sentiment: 'neutral',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'thoughtful_manager',
    text: 'We are pleased to inform you that your application is advancing to the subsequent phase of evaluation. Thank you for your patience during this process.',
    referenced_document_ids: 'D000005',
    thread_id: 'TC0001-001',
  },
  {
    message_id: 'M000004',
    customer_id: 'C0001',
    message_time: '2023-09-18T03:42:52',
    channel: 'email',
    message_role: 'customer',
    phase_label: 'onboarding',
    agent_id: '',
    agent_persona: '',
    agent_role: '',
    agent_tone: '',
    sentiment: 'neutral',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'thoughtful_manager',
    text: 'Hi, I wanted to check on the status of my loan renewal application. I submitted the documents last week. Please let me know if anything else is needed.',
    referenced_document_ids: null,
    thread_id: 'TC0001-001',
  },
  {
    message_id: 'M000005',
    customer_id: 'C0001',
    message_time: '2023-09-20T10:15:00',
    channel: 'email',
    message_role: 'agent',
    phase_label: 'underwriting',
    agent_id: 'A008',
    agent_persona: 'relationship_manager',
    agent_role: 'account_manager',
    agent_tone: 'friendly',
    sentiment: 'positive',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'thoughtful_manager',
    text: 'Great news! Your application has been approved and is now in the final documentation stage. We appreciate your patience and look forward to continuing our partnership.',
    referenced_document_ids: null,
    thread_id: 'TC0001-001',
  },
  {
    message_id: 'M000006',
    customer_id: 'C0002',
    message_time: '2024-01-05T09:00:00',
    channel: 'email',
    message_role: 'agent',
    phase_label: 'review',
    agent_id: 'A003',
    agent_persona: 'relationship_manager',
    agent_role: 'account_manager',
    agent_tone: 'professional',
    sentiment: 'positive',
    churn_label: 0,
    loan_outcome: 'approved',
    customer_persona: 'thoughtful_manager',
    text: 'Happy New Year! As we begin 2024, I wanted to reach out to discuss your credit line and any expansion plans Summit Enterprises might have.',
    referenced_document_ids: null,
    thread_id: 'TC0002-001',
  },
  {
    message_id: 'M000007',
    customer_id: 'C0002',
    message_time: '2024-01-08T14:30:00',
    channel: 'email',
    message_role: 'customer',
    phase_label: 'review',
    agent_id: '',
    agent_persona: '',
    agent_role: '',
    agent_tone: '',
    sentiment: 'positive',
    churn_label: 0,
    loan_outcome: 'approved',
    customer_persona: 'thoughtful_manager',
    text: 'Thank you for reaching out! Yes, we are looking to expand our operations. Would love to discuss increasing our credit line.',
    referenced_document_ids: null,
    thread_id: 'TC0002-001',
  },
  {
    message_id: 'M000008',
    customer_id: 'C0003',
    message_time: '2023-11-01T11:00:00',
    channel: 'email',
    message_role: 'customer',
    phase_label: 'servicing',
    agent_id: '',
    agent_persona: '',
    agent_role: '',
    agent_tone: '',
    sentiment: 'negative',
    churn_label: 1,
    loan_outcome: 'closed_paid_off',
    customer_persona: 'busy_founder',
    text: 'I am disappointed with the response time on my recent inquiry. This has been an ongoing issue and I am considering paying off the loan early.',
    referenced_document_ids: null,
    thread_id: 'TC0003-001',
  },
  {
    message_id: 'M000009',
    customer_id: 'C0003',
    message_time: '2023-11-02T09:30:00',
    channel: 'phone',
    message_role: 'agent',
    phase_label: 'servicing',
    agent_id: 'A015',
    agent_persona: 'relationship_manager',
    agent_role: 'account_manager',
    agent_tone: 'empathetic',
    sentiment: 'neutral',
    churn_label: 1,
    loan_outcome: 'closed_paid_off',
    customer_persona: 'busy_founder',
    text: 'I completely understand your frustration and sincerely apologize for the delays. I would like to personally ensure your concerns are addressed immediately.',
    referenced_document_ids: null,
    thread_id: 'TC0003-001',
  },
  {
    message_id: 'M000010',
    customer_id: 'C0004',
    message_time: '2024-02-15T16:00:00',
    channel: 'email',
    message_role: 'agent',
    phase_label: 'renewal',
    agent_id: 'A007',
    agent_persona: 'sales_specialist',
    agent_role: 'sales',
    agent_tone: 'persuasive',
    sentiment: 'positive',
    churn_label: 0,
    loan_outcome: 'renewed',
    customer_persona: 'impatient_owner',
    text: 'Your credit line is up for renewal next month. Based on your excellent payment history, you may qualify for an increased limit with better terms.',
    referenced_document_ids: null,
    thread_id: 'TC0004-001',
  },
];

// =============================================================================
// Data Access Functions
// =============================================================================

export function getAllCustomers(): Customer[] {
  return mockCustomers;
}

export function getCustomerById(id: string): Customer | undefined {
  return mockCustomers.find((c) => c.customer_id === id);
}

export function getDocumentsForCustomer(customerId: string): Document[] {
  return mockDocuments.filter((d) => d.customer_id === customerId);
}

export function getMessagesForCustomer(customerId: string): Message[] {
  return mockMessages.filter((m) => m.customer_id === customerId);
}

export function getMessagesByThread(customerId: string): Map<string, Message[]> {
  const messages = getMessagesForCustomer(customerId);
  const threads = new Map<string, Message[]>();
  
  messages.forEach((msg) => {
    const existing = threads.get(msg.thread_id) || [];
    existing.push(msg);
    threads.set(msg.thread_id, existing);
  });
  
  // Sort messages within each thread by time
  threads.forEach((msgs, threadId) => {
    msgs.sort((a, b) => new Date(a.message_time).getTime() - new Date(b.message_time).getTime());
    threads.set(threadId, msgs);
  });
  
  return threads;
}

